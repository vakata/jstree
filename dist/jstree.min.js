/*! jstree - v1.0.0 - 2012-04-09
* http://jstree.com
* Copyright (c) 2012 Ivan Bozhanov; Licensed MIT, GPL */
(function(a){a.vakata={}})(jQuery),function(a){a.fn.vakata_reverse=[].reverse}(jQuery),function(a){jQuery.expr[":"].vakata_icontains=function(a,b,c){return(a.textContent||a.innerText||"").toLowerCase().indexOf(c[3].toLowerCase())>=0}}(jQuery),function(a){a.vakata.array_remove=function(a,b,c){var d=a.slice((c||b)+1||a.length);return a.length=b<0?a.length+b:b,a.push.apply(a,d),a}}(jQuery),function(a){a.vakata.array_unique=function(a){var b=[],c,d,e;for(c=0,e=a.length;c<e;c++){for(d=0;d<=c;d++)if(a[c]===a[d])break;d===c&&b.push(a[c])}return b}}(jQuery),function(a){a.vakata.attributes=function(b,c){b=a(b)[0];var d=c?{}:[];return a.each(b.attributes,function(b,e){if(a.inArray(e.nodeName.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])!==-1)return;e.nodeValue!==null&&a.trim(e.nodeValue)!==""&&(c?d[e.nodeName]=e.nodeValue:d.push(e.nodeName))}),d}}(jQuery),function(a){var b;a.vakata.get_scrollbar_width=function(){var c,d;return b||(/msie/.test(navigator.userAgent.toLowerCase())?(c=a('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1e3,left:0}).appendTo("body"),d=a('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1e3,left:0}).appendTo("body"),b=c.width()-d.width(),c.add(d).remove()):(c=a("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1e3,left:0}).prependTo("body").append("<div />").find("div").css({width:"100%",height:200}),b=100-c.width(),c.parent().remove())),b}}(jQuery),function(a){a.vakata.css={get_css:function(a,b,c){a=a.toLowerCase();var d=c.cssRules||c.rules,e=0;do{if(d.length&&e>d.length+5)return!1;if(d[e].selectorText&&d[e].selectorText.toLowerCase()===a)return b===!0?(c.removeRule&&c.removeRule(e),c.deleteRule&&c.deleteRule(e),!0):d[e]}while(d[++e]);return!1},add_css:function(b,c){return a.jstree.css.get_css(b,!1,c)?!1:(c.insertRule?c.insertRule(b+" { }",0):c.addRule(b,null,0),a.vakata.css.get_css(b))},remove_css:function(b,c){return a.vakata.css.get_css(b,!0,c)},add_sheet:function(b){var c=!1,d=!0;if(b.str)return b.title&&(c=a("style[id='"+b.title+"-stylesheet']")[0]),c?d=!1:(c=document.createElement("style"),c.setAttribute("type","text/css"),b.title&&c.setAttribute("id",b.title+"-stylesheet")),c.styleSheet?d?(document.getElementsByTagName("head")[0].appendChild(c),c.styleSheet.cssText=b.str):c.styleSheet.cssText=c.styleSheet.cssText+" "+b.str:(c.appendChild(document.createTextNode(b.str)),document.getElementsByTagName("head")[0].appendChild(c)),c.sheet||c.styleSheet;if(b.url){if(!document.createStyleSheet)return c=document.createElement("link"),c.rel="stylesheet",c.type="text/css",c.media="all",c.href=b.url,document.getElementsByTagName("head")[0].appendChild(c),c.styleSheet;try{c=document.createStyleSheet(b.url)}catch(e){}}}}}(jQuery),function(a){var b={element:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1};a.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5},_trigger:function(b,c){var d=a.vakata.dnd._get();d.event=c,a(document).triggerHandler("dnd_"+b+".vakata",d)},_get:function(){return{data:b.data,element:b.element,helper:b.helper}},_clean:function(){b.helper&&b.helper.remove(),b.scroll_i&&(clearInterval(b.scroll_i),b.scroll_i=!1),b={element:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1},a(document).unbind("mousemove",a.vakata.dnd.drag),a(document).unbind("mouseup",a.vakata.dnd.stop)},_scroll:function(c){if(!b.scroll_e||!b.scroll_l&&!b.scroll_t)return b.scroll_i&&(clearInterval(b.scroll_i),b.scroll_i=!1),!1;if(!b.scroll_i)return b.scroll_i=setInterval(a.vakata.dnd._scroll,100),!1;if(c===!0)return!1;var d=b.scroll_e.scrollTop(),e=b.scroll_e.scrollLeft();b.scroll_e.scrollTop(d+b.scroll_t*a.vakata.dnd.settings.scroll_speed),b.scroll_e.scrollLeft(e+b.scroll_l*a.vakata.dnd.settings.scroll_speed),(d!==b.scroll_e.scrollTop()||e!==b.scroll_e.scrollLeft())&&a.vakata.dnd._trigger("scroll",b.scroll_e)},start:function(c,d,e){b.is_drag&&a.vakata.dnd.stop({});try{c.currentTarget.unselectable="on",c.currentTarget.onselectstart=function(){return!1},c.currentTarget.style&&(c.currentTarget.style.MozUserSelect="none")}catch(f){}return b.init_x=c.pageX,b.init_y=c.pageY,b.data=d,b.is_down=!0,b.element=c.currentTarget,e!==!1&&(b.helper=a("<div id='vakata-dnd'></div>").html(e).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),a(document).bind("mousemove",a.vakata.dnd.drag),a(document).bind("mouseup",a.vakata.dnd.stop),!1},drag:function(c){if(!b.is_down)return;if(!b.is_drag)if(Math.abs(c.pageX-b.init_x)>a.vakata.dnd.settings.threshold||Math.abs(c.pageY-b.init_y)>a.vakata.dnd.settings.threshold)b.helper&&(b.helper.appendTo("body"),b.helper_w=b.helper.outerWidth()),b.is_drag=!0,a.vakata.dnd._trigger("start",c);else return;var d=!1,e=!1,f=!1,g=!1,h=!1,i=!1,j=!1,k=!1,l=!1,m=!1;b.scroll_t=0,b.scroll_l=0,b.scroll_e=!1;var n=a(c.target).parentsUntil("body").andSelf().vakata_reverse().filter(function(){return/^auto|scroll$/.test(a(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var d=a(this),e=d.offset();this.scrollHeight>this.offsetHeight&&(e.top+d.height()-c.pageY<a.vakata.dnd.settings.scroll_proximity&&(b.scroll_t=1),c.pageY-e.top<a.vakata.dnd.settings.scroll_proximity&&(b.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(e.left+d.width()-c.pageX<a.vakata.dnd.settings.scroll_proximity&&(b.scroll_l=1),c.pageX-e.left<a.vakata.dnd.settings.scroll_proximity&&(b.scroll_l=-1));if(b.scroll_t||b.scroll_l)return b.scroll_e=a(this),!1});if(!b.scroll_e){d=a(document),e=a(window),f=d.height(),g=e.height(),h=d.width(),i=e.width(),j=d.scrollTop(),k=d.scrollLeft(),f>g&&c.pageY-j<a.vakata.dnd.settings.scroll_proximity&&(b.scroll_t=-1),f>g&&g-(c.pageY-j)<a.vakata.dnd.settings.scroll_proximity&&(b.scroll_t=1),h>i&&c.pageX-k<a.vakata.dnd.settings.scroll_proximity&&(b.scroll_l=-1),h>i&&i-(c.pageX-k)<a.vakata.dnd.settings.scroll_proximity&&(b.scroll_l=1);if(b.scroll_t||b.scroll_l)b.scroll_e=d}b.scroll_e&&a.vakata.dnd._scroll(!0),b.helper&&(l=parseInt(c.pageY+a.vakata.dnd.settings.helper_top,10),m=parseInt(c.pageX+a.vakata.dnd.settings.helper_left,10),f&&l+25>f&&(l=f-50),h&&m+b.helper_w>h&&(m=h-(b.helper_w+2)),b.helper.css({left:m+"px",top:l+"px"})),a.vakata.dnd._trigger("move",c)},stop:function(c){b.is_drag&&a.vakata.dnd._trigger("stop",c),a.vakata.dnd._clean()}}}(jQuery),function(a){a.vakata.xslt=function(b,c){var d=!1,e,f,g;if(d===!1&&window.ActiveXObject)try{d=new ActiveXObject("Msxml2.XSLTemplate"),f=new ActiveXObject("Msxml2.DOMDocument"),f.loadXML(b),g=new ActiveXObject("Msxml2.FreeThreadedDOMDocument"),g.loadXML(c),d.stylesheet=g,e=d.createProcessor(),e.input=f,e.transform(),d=e.output}catch(h){}return b=a.parseXML(b),c=a.parseXML(c),d===!1&&typeof XSLTProcessor!="undefined"&&(e=new XSLTProcessor,e.importStylesheet(c),d=e.transformToFragment(b,document),d=a("<div />").append(d).html()),d===!1&&typeof b.transformNode!="undefined"&&(d=b.transformNode(c)),d}}(jQuery),typeof jQuery.hotkeys=="undefined"&&function(a){function b(a){if(typeof a.data!="string")return;var b=a.handler,c=a.data.toLowerCase().split(" ");a.handler=function(a){if(!(this===a.target||!/textarea|select/i.test(a.target.nodeName)&&a.target.type!=="text"))return;var d=a.type!=="keypress"&&jQuery.vakata_hotkeys.specialKeys[a.which],e=String.fromCharCode(a.which).toLowerCase(),f,g="",h={};a.altKey&&d!=="alt"&&(g+="alt+"),a.ctrlKey&&d!=="ctrl"&&(g+="ctrl+"),a.metaKey&&!a.ctrlKey&&d!=="meta"&&(g+="meta+"),a.shiftKey&&d!=="shift"&&(g+="shift+"),d?h[g+d]=!0:(h[g+e]=!0,h[g+jQuery.vakata_hotkeys.shiftNums[e]]=!0,g==="shift+"&&(h[jQuery.vakata_hotkeys.shiftNums[e]]=!0));for(var i=0,j=c.length;i<j;i++)if(h[c[i]])return b.apply(this,arguments)}}a.vakata_hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}},jQuery.each(["keydown","keyup","keypress"],function(){jQuery.event.special[this]={add:b}})}(jQuery),function(a){var b=!1,c={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};a.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(b){a(document).triggerHandler("context_"+b+".vakata",{reference:c.reference,element:c.element,position:{x:c.position_x,y:c.position_y}})},_execute:function(a){return a=c.items[a],a&&!a._disabled&&a.action?a.action.call(null,{item:a,reference:c.reference,element:c.element,position:{x:c.position_x,y:c.position_y}}):!1},_parse:function(b,d){if(!b)return!1;d||(c.html="",c.items=[]);var e="",f=!1,g;return d&&(e+="<ul>"),a.each(b,function(b,d){if(!d)return!0;c.items.push(d),!f&&d.separator_before&&(e+="<li class='vakata-context-separator'><a href='#' "+(a.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"),f=!1,e+="<li class='"+(d._class||"")+(d._disabled?" vakata-contextmenu-disabled ":"")+"'>",e+="<a href='#' rel='"+(c.items.length-1)+"'>",a.vakata.context.settings.icons&&(e+="<ins ",d.icon&&(d.icon.indexOf("/")!==-1?e+=" style='background:url(\""+d.icon+"\") center center no-repeat' ":e+=" class='"+d.icon+"' "),e+=">&#160;</ins><span>&#160;</span>"),e+=d.label+"</a>",d.submenu&&(g=a.vakata.context._parse(d.submenu,!0),g&&(e+=g)),e+="</li>",d.separator_after&&(e+="<li class='vakata-context-separator'><a href='#' "+(a.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>",f=!0)}),e=e.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),d&&(e+="</ul>"),d||(c.html=e,a.vakata.context._trigger("parse")),e.length>10?e:!1},_show_submenu:function(c){c=a(c);if(!c.length||!c.children("ul").length)return;var d=c.children("ul"),e=c.offset().left+c.outerWidth(),f=c.offset().top,g=d.width(),h=d.height(),i=a(document).width(),j=a(document).height();b?c[e-(g+10+c.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):c[e+g+10>i?"addClass":"removeClass"]("vakata-context-right"),f+h+10>j&&d.css("bottom","-1px"),d.show()},show:function(b,d,e){c.element&&c.element.length&&c.element.width("");switch(!0){case!d&&!b:return!1;case!!d&&!!b:c.reference=b,c.position_x=d.x,c.position_y=d.y;break;case!d&&!!b:c.reference=b;var f=b.offset();c.position_x=f.left+b.outerHeight(),c.position_y=f.top;break;case!!d&&!b:c.position_x=d.x,c.position_y=d.y}!!b&&!e&&a(b).data("vakata_contextmenu")&&(e=a(b).data("vakata_contextmenu")),a.vakata.context._parse(e)&&c.element.html(c.html);if(c.items.length){var g=c.element,h=c.position_x,i=c.position_y,j=g.width(),k=g.height(),l=a(document).width(),m=a(document).height();h+j+20>l&&(h=l-(j+20)),i+k+20>m&&(i=m-(k+20)),c.element.css({left:h,top:i}).show().width(c.element.outerWidth()),c.is_visible=!0,a.vakata.context._trigger("show")}},hide:function(){c.is_visible&&(c.element.hide().find("ul").hide(),c.is_visible=!1,a.vakata.context._trigger("hide"))}},a(function(){b=a("body").css("direction")==="rtl";var d=!1,e='.vakata-context { display:none; _width:1px; } .vakata-context, .vakata-context ul { margin:0; padding:2px; position:absolute; background:#f5f5f5; border:1px solid #979797; \t-moz-box-shadow:5px 5px 4px -4px #666666; -webkit-box-shadow:2px 2px 2px #999999; box-shadow:2px 2px 2px #999999; }.vakata-context ul { list-style:none; left:100%; margin-top:-2.7em; margin-left:-4px; } .vakata-context li.vakata-context-right ul { left:auto; right:100%; margin-left:auto; margin-right:-4px; } .vakata-context li { list-style:none; display:inline; }.vakata-context li a { display:block; padding:0 2em 0 2em; text-decoration:none; width:auto; color:black; white-space:nowrap; line-height:2.4em; \t-moz-text-shadow:1px 1px 0px white; -webkit-text-shadow:1px 1px 0px white; text-shadow:1px 1px 0px white; \t-moz-border-radius:1px; -webkit-border-radius:1px; border-radius:1px; }.vakata-context li a:hover { position:relative; background-color:#e8eff7; \t-moz-box-shadow:0px 0px 2px #0a6aa1; -webkit-box-shadow:0px 0px 2px #0a6aa1; box-shadow:0px 0px 2px #0a6aa1; }.vakata-context li.vakata-context-hover > a { position:relative; background-color:#e8eff7; \t-moz-box-shadow:0px 0px 2px #0a6aa1; -webkit-box-shadow:0px 0px 2px #0a6aa1; box-shadow:0px 0px 2px #0a6aa1; }.vakata-context li a.vakata-context-parent { background-image:url("data:image/gif;base64,R0lGODlhCwAHAIAAACgoKP///yH5BAEAAAEALAAAAAALAAcAAAIORI4JlrqN1oMSnmmZDQUAOw=="); background-position:right center; background-repeat:no-repeat; } .vakata-context li.vakata-context-separator a, .vakata-context li.vakata-context-separator a:hover { background:white; border:0; border-top:1px solid #e2e3e3; height:1px; min-height:1px; max-height:1px; padding:0; margin:0 0 0 2.4em; border-left:1px solid #e0e0e0; _overflow:hidden; \t-moz-text-shadow:0 0 0 transparent; -webkit-text-shadow:0 0 0 transparent; text-shadow:0 0 0 transparent; \t-moz-box-shadow:0 0 0 transparent; -webkit-box-shadow:0 0 0 transparent; box-shadow:0 0 0 transparent; \t-moz-border-radius:0; -webkit-border-radius:0; border-radius:0; }.vakata-context li.vakata-contextmenu-disabled a, .vakata-context li.vakata-contextmenu-disabled a:hover { color:silver; background-color:transparent; border:0; box-shadow:0 0 0; }.vakata-context li a ins { text-decoration:none; display:inline-block; width:2.4em; height:2.4em; background:transparent; margin:0 0 0 -2em; } .vakata-context li a span { display:inline-block; width:1px; height:2.4em; background:white; margin:0 0.5em 0 0; border-left:1px solid #e2e3e3; _overflow:hidden; } .vakata-context-rtl ul { left:auto; right:100%; margin-left:auto; margin-right:-4px; } .vakata-context-rtl li a.vakata-context-parent { background-image:url("data:image/gif;base64,R0lGODlhCwAHAIAAACgoKP///yH5BAEAAAEALAAAAAALAAcAAAINjI+AC7rWHIsPtmoxLAA7"); background-position:left center; background-repeat:no-repeat; } .vakata-context-rtl li.vakata-context-separator a { margin:0 2.4em 0 0; border-left:0; border-right:1px solid #e2e3e3;} .vakata-context-rtl li.vakata-context-left ul { right:auto; left:100%; margin-left:-4px; margin-right:auto; } .vakata-context-rtl li a ins { margin:0 -2em 0 0; } .vakata-context-rtl li a span { margin:0 0 0 0.5em; border-left-color:white; background:#e2e3e3; } ';a.vakata.css.add_sheet({str:e,title:"vakata-context"}),c.element=a("<ul class='vakata-context'></ul>"),c.element.delegate("li","mouseenter",function(b){b.stopImmediatePropagation();if(a.contains(this,b.relatedTarget))return;d&&clearTimeout(d),c.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),a(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").andSelf().addClass("vakata-context-hover"),a.vakata.context._show_submenu(this)}).delegate("li","mouseleave",function(b){if(a.contains(this,b.relatedTarget))return;a(this).find(".vakata-context-hover").andSelf().removeClass("vakata-context-hover")}).bind("mouseleave",function(b){a(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),a.vakata.context.settings.hide_onmouseleave&&(d=setTimeout(function(b){return function(){a.vakata.context.hide()}}(this),a.vakata.context.settings.hide_onmouseleave))}).delegate("a","click",function(a){a.preventDefault()}).delegate("a","mouseup",function(b){!a(this).blur().parent().hasClass("vakata-context-disabled")&&a.vakata.context._execute(a(this).attr("rel"))!==!1&&a.vakata.context.hide()}).appendTo("body"),a(document).bind("mousedown",function(b){c.is_visible&&!a.contains(c.element[0],b.target)&&a.vakata.context.hide()}).bind("context_show.vakata",function(a,d){c.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),b&&c.element.addClass("vakata-context-rtl").css("direction","rtl"),c.element.find("ul").hide().end()}),(typeof a.hotkeys!="undefined"||typeof a.vakata_hotkeys!="undefined")&&a(document).bind("keydown","up",function(a){if(c.is_visible){var b=c.element.find("ul:visible").andSelf().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first();b.length||(b=c.element.find("ul:visible").andSelf().last().children("li:not(.vakata-context-separator)").last()),b.addClass("vakata-context-hover"),a.stopImmediatePropagation(),a.preventDefault()}}).bind("keydown","down",function(a){if(c.is_visible){var b=c.element.find("ul:visible").andSelf().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first();b.length||(b=c.element.find("ul:visible").andSelf().last().children("li:not(.vakata-context-separator)").first()),b.addClass("vakata-context-hover"),a.stopImmediatePropagation(),a.preventDefault()}}).bind("keydown","right",function(a){c.is_visible&&(c.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover"),a.stopImmediatePropagation(),a.preventDefault())}).bind("keydown","left",function(a){c.is_visible&&(c.element.find(".vakata-context-hover").last().parents("li:eq(0)").find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover"),a.stopImmediatePropagation(),a.preventDefault())}).bind("keydown","esc",function(b){a.vakata.context.hide(),b.preventDefault()}).bind("keydown","space",function(a){c.element.find(".vakata-context-hover").last().children("a").click(),a.preventDefault()})})}(jQuery),function(a){var b=function(a){var b=/["\\\x00-\x1f\x7f-\x9f]/g,c={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return a.match(b)?'"'+a.replace(b,function(a){var b=c[a];return typeof b=="string"?b:(b=a.charCodeAt(),"\\u00"+Math.floor(b/16).toString(16)+(b%16).toString(16))})+'"':'"'+a+'"'};a.vakata.json={encode:function(c){if(c===null)return"null";var d=[],e;switch(typeof c){case"undefined":return undefined;case"number":case"boolean":return c+"";case"string":return b(c);case"object":if(a.isFunction(c.toJSON))return a.vakata.json.encode(c.toJSON());if(c.constructor===Date)return'"'+c.getUTCFullYear()+"-"+String("0"+(c.getUTCMonth()+1)).slice(-2)+"-"+String("0"+c.getUTCDate()).slice(-2)+"T"+String("0"+c.getUTCHours()).slice(-2)+":"+String("0"+c.getUTCMinutes()).slice(-2)+":"+String("0"+c.getUTCSeconds()).slice(-2)+"."+String("00"+c.getUTCMilliseconds()).slice(-3)+'Z"';if(c.constructor===Array){for(e=0;e<c.length;e++)d.push(a.vakata.json.encode(c[e])||"null");return"["+d.join(",")+"]"}return a.each(c,function(c,e){if(a.isFunction(e))return!0;c=typeof c=="number"?'"'+c+'"':b(c),e=a.vakata.json.encode(e),d.push(c+":"+e)}),"{"+d.join(", ")+"}"}},decode:function(b){return a.parseJSON(b)}}}(jQuery),function(a){a.vakata.cookie=function(b,c,d){var e,f,g,h;if(arguments.length>1&&String(c)!=="[object Object]"){d=a.extend({},d);if(c===null||c===undefined)d.expires=-1;return typeof d.expires=="number"&&(e=d.expires,f=d.expires=new Date,f.setDate(f.getDate()+e)),c=String(c),document.cookie=[encodeURIComponent(b),"=",d.raw?c:encodeURIComponent(c),d.expires?"; expires="+d.expires.toUTCString():"",d.path?"; path="+d.path:"",d.domain?"; domain="+d.domain:"",d.secure?"; secure":""].join("")}return d=c||{},h=d.raw?function(a){return a}:decodeURIComponent,(g=(new RegExp("(?:^|; )"+encodeURIComponent(b)+"=([^;]*)")).exec(document.cookie))?h(g[1]):null}}(jQuery),function(a){function j(){var b=!1;if("localStorage"in window)try{window.localStorage.setItem("_tmptest","tmpval"),b=!0,window.localStorage.removeItem("_tmptest")}catch(e){}if(b)try{window.localStorage&&(c=window.localStorage,h="localStorage")}catch(f){}else if("globalStorage"in window)try{window.globalStorage&&(c=window.globalStorage[window.location.hostname],h="globalStorage")}catch(g){}else{d=document.createElement("link");if(d.addBehavior){d.style.behavior="url(#default#userData)",document.getElementsByTagName("head")[0].appendChild(d);try{d.load("jStorage");var i="{}";i=d.getAttribute("jStorage"),c.jStorage=i,h="userDataBehavior"}catch(j){}}!h&&(!!a.vakata.cookie("__vjstorage")||a.vakata.cookie("__vjstorage","{}",{expires:365})&&a.vakata.cookie("__vjstorage")==="{}")&&(d=null,c.jStorage=a.vakata.cookie("__vjstorage"),h="cookie");if(!h){d=null;return}}k(),n()}function k(){if(c.jStorage)try{b=g(String(c.jStorage))}catch(a){c.jStorage="{}"}else c.jStorage="{}";e=c.jStorage?String(c.jStorage).length:0}function l(){try{c.jStorage=f(b),h==="userDataBehavior"&&(d.setAttribute("jStorage",c.jStorage),d.save("jStorage")),h==="cookie"&&a.vakata.cookie("__vjstorage",c.jStorage,{expires:365}),e=c.jStorage?String(c.jStorage).length:0}catch(g){}}function m(a){if(!a||typeof a!="string"&&typeof a!="number")throw new TypeError("Key name must be string or numeric");if(a==="__jstorage_meta")throw new TypeError("Reserved key name");return!0}function n(){var a=+(new Date),c,d,e=Infinity,f=!1;i!==!1&&clearTimeout(i);if(!b.__jstorage_meta||typeof b.__jstorage_meta.TTL!="object")return;d=b.__jstorage_meta.TTL;for(c in d)d.hasOwnProperty(c)&&(d[c]<=a?(delete d[c],delete b[c],f=!0):d[c]<e&&(e=d[c]));e!==Infinity&&(i=setTimeout(n,e-a)),f&&l()}var b={},c={jStorage:"{}"},d=null,e=0,f=a.vakata.json.encode,g=a.vakata.json.decode,h=!1,i=!1;a.vakata.storage={version:"0.1.6.1",set:function(a,c){return m(a),b[a]=c,l(),c},get:function(a,c){return m(a),a in b?b[a]:typeof c=="undefined"?null:c},del:function(a){return m(a),a in b?(delete b[a],b.__jstorage_meta&&typeof b.__jstorage_meta.TTL=="object"&&a in b.__jstorage_meta.TTL&&delete b.__jstorage_meta.TTL[a],l(),!0):!1},setTTL:function(a,c){var d=+(new Date);return m(a),c=Number(c)||0,a in b?(b.__jstorage_meta||(b.__jstorage_meta={}),b.__jstorage_meta.TTL||(b.__jstorage_meta.TTL={}),c>0?b.__jstorage_meta.TTL[a]=d+c:delete b.__jstorage_meta.TTL[a],l(),n(),!0):!1},flush:function(){return b={},l(),!0},storageObj:function(){function a(){}return a.prototype=b,new a},index:function(){var c=[],d;return a.each(b,function(a,b){a!=="__jstorage_meta"&&c.push(a)}),c},storageSize:function(){return e},currentBackend:function(){return h},storageAvailable:function(){return!!h}},j()}(jQuery),function(a){a.vakata.pretty_date={lang:{ago:"Ago",from:"From Now",now:"Just Now",minute:"Minute",minutes:"Minutes",hour:"Hour",hours:"Hours",day:"Day",days:"Days",week:"Week",weeks:"Weeks",month:"Month",months:"Months",year:"Year",years:"Years"},parse:function(b,c){b=new Date(b.replace(/-/g,"/").replace(/[TZ]/g," ").replace(/\+\d\d\:\d\d$/,"")),c=c||new Date;var d=a.vakata.pretty_date.lang,e=[[60,d.now],[3600,d.minute,d.minutes,60],[86400,d.hour,d.hours,3600],[604800,d.day,d.days,86400],[2628e3,d.week,d.weeks,604800],[31536e3,d.month,d.months,2628e3],[Infinity,d.year,d.years,31536e3]],f=(c-b+c.getTimezoneOffset()*6e4)/1e3,g=function(a,b){var c=.1;return a>=b&&a<=b*(1+c)?b:a},h;f<0?(f=Math.abs(f),h=" "+d.from):h=" "+d.ago;for(var i=0,j=e[0];e[i];j=e[++i])if(f<j[0]){if(i===0)return j[1];var k=Math.ceil(g(f,j[3])/j[3]);return k+" "+(k!==1?j[2]:j[1])+(i>0?h:"")}},init:function(b,c){a("time, [datetime]").vakata_pretty_date(c),setInterval(function(){a("time, [datetime]").vakata_pretty_date(c)},b||6e4)}},a.fn.vakata_pretty_date=function(b,c){return b||(b="%{s}"),this.each(function(){var d=jQuery(this),e=a.vakata.pretty_date.parse(d.attr("datetime"),c);e&&(e=b.replace("%{s}",e),d.html()!==e&&d.html(e))})}}(jQuery),function(a){a.vakata.selection={get:function(a){if(window.getSelection){if(a)return window.getSelection().toString();var b=window.getSelection(),c=b.getRangeAt&&b.rangeCount?b.getRangeAt(0):document.createRange(),d=document.createElement("div");return b.getRangeAt||(c.setStart(b.anchorNode,b.anchorOffset),c.setEnd(b.focusNode,b.focusOffset)),d.appendChild(c.cloneContents()),d.innerHTML}return document.selection?document.selection.createRange()[a?"text":"htmlText"]:""},elm_get:function(a){a=typeof a=="string"?document.getElementById(a):a,a.jquery&&(a=a.get(0));if("selectionStart"in a)return{start:a.selectionStart,end:a.selectionEnd,length:a.selectionEnd-a.selectionStart,text:a.value.substr(a.selectionStart,a.selectionEnd-a.selectionStart)};if(!document.selection)return{start:a.value.length,end:a.value.length,length:0,text:""};a.focus();var b=document.selection.createRange(),c=!1,d=!1,e,f,g,h;if(b&&b.parentElement()===a)return e=a.value.length,f=a.value.replace(/\r\n/g,"\n"),c=a.createTextRange(),c.moveToBookmark(b.getBookmark()),d=a.createTextRange(),d.collapse(!1),c.compareEndPoints("StartToEnd",d)>-1?g=h=e:(g=-c.moveStart("character",-e),g+=f.slice(0,g).split("\n").length-1,c.compareEndPoints("EndToEnd",d)>-1?h=e:(h=-c.moveEnd("character",-e),h+=f.slice(0,h).split("\n").length-1)),f=a.value.slice(g,h),{start:g,end:h,length:f.length,text:f}},elm_set:function(b,c,d){b=typeof b=="string"?document.getElementById(b):b,b.jquery&&(b=b.get(0));if("selectionStart"in b)b.focus(),b.selectionStart=c,b.selectionEnd=d;else if(document.selection){b.focus();var e=b.createTextRange(),f=b.value.replace(/\r\n/g,"\n");c-=f.slice(0,c).split("\n").length-1,d-=f.slice(0,d).split("\n").length-1,e.collapse(!0),e.moveEnd("character",d),e.moveStart("character",c),e.select()}return a.vakata.selection.elm_get(b)},elm_replace:function(b,c){b=typeof b=="string"?document.getElementById(b):b,b.jquery&&(b=b.get(0));var d=a.vakata.selection.elm_get(b),e=d.start,f=e+c.length;return b.value=b.value.substr(0,e)+c+b.value.substr(d.end,b.value.length),a.vakata.selection.elm_set(b,e,f),{start:e,end:f,length:c.length,text:c}},elm_get_caret:function(b){return a.vakata.selection.elm_get(b).end},elm_set_caret:function(b,c){return a.vakata.selection.elm_set(b,c,c)},elm_get_caret_position:function(b){b=typeof b=="string"?document.getElementById(b):b,b.jquery&&(b=b.get(0));var c=a.vakata.selection.elm_get_caret(b),d=b.value.substring(0,c).replace(/&/g,"&amp;").replace(/</ig,"&lt;").replace(/>/ig,"&gt;").replace(/\r/g,"").replace(/\t/g,"&#10;").replace(/\n/ig,"<br />"),e=a.vakata.get_scrollbar_width(),f=a(b).width(),g=a(b).height();return b.scrollHeight>g&&(f-=e),b.scrollWidth>f&&(g-=e),b=a(b),b=a("<div />").html(d).css({background:"red",width:f+"px",height:"auto",position:"absolute",left:"0px",top:"-10000px",fontSize:b.css("fontSize"),fontFamily:b.css("fontFamily"),fontWeight:b.css("fontWeight"),fontVariant:b.css("fontVariant"),fontStyle:b.css("fontStyle"),textTransform:b.css("textTransform"),lineHeight:b.css("lineHeight"),whiteSpace:"pre-wrap"}),b.append('<span class="caret">&nbsp;</span>').appendTo("body"),d=b.find("span.caret"),c=d.offset(),c.top=c.top+1e4+d.height(),b.remove(),c}}}(jQuery),function(a){a.fn.vakata_highlight=function(b){var c=this;return typeof b=="string"&&(b=[b]),a.isArray(b)&&(b={words:b}),b=a.extend(!0,{},{css_class:"vakata-highlight",words:[],color:"#99ccff"},b),b.words.length&&this.each(function(){var c=a(this);a.each(b.words,function(d,e){var f=!1;typeof b.color=="string"&&(f=b.color),a.isArray(b.color)&&typeof b.color[d]=="string"&&(f=b.color[d]),c.find(':vakata_icontains("'+e.replace(/\"/ig,"")+'")').filter("strong, span, li, p, h1, h2, h3, h4, h5, h6, div, u, em, i, dt, dd").contents().filter(function(){return this.nodeType===3}).each(function(){if(this.nodeValue.toLowerCase().indexOf(e.toLowerCase())>=0){this.nodeValue=this.nodeValue.replace(new RegExp("("+e.replace(/([\-.*+?\^${}()|\[\]\/\\])/g,"\\$1")+")","ig"),"|{{{$1}}}|");var c=a(this).parent();c.html(c.html().replace(/\|\{\{\{/g,'<span class="'+b.css_class+" "+b.css_class+"-"+d+'" '+(typeof f=="string"?' style="background:'+f+';" ':"")+">").replace(/\}\}\}\|/g,"</span>"))}})})}),c}}(jQuery),function(){"use strict";if(!jQuery)throw"jsTree: jQuery not included.";if(jQuery.jstree)return;(function(a){var b=[],c=-1,d={},e={};a.jstree={VERSION:"1.0.0",IS_IE6:jQuery.browser.msie&&parseInt(jQuery.browser.version,10)===6,IS_IE7:jQuery.browser.msie&&parseInt(jQuery.browser.version,10)===6,IS_FF2:jQuery.browser.mozilla&&parseFloat(jQuery.browser.version,10)<1.9,__construct:function(c){var e={},f={},g=[],h=[],i=0;return c=a(c),a.jstree._reference(c)&&a.jstree.__destruct(c),a.extend.apply(null,[!0,e].concat(Array.prototype.slice.call(arguments,1),c.data("jstree")||{})),g=a.isArray(e.plugins)?e.plugins:a.jstree.defaults.plugins.slice(),g=a.vakata.array_unique(g),e=a.extend(!0,{},a.jstree.defaults,e),a.each(d,function(b,c){b!=="core"&&a.inArray(b,g)===-1?(e[b]=null,delete e[b]):(h.push(b),f[b]={})}),e.plugins=h,i=parseInt(b.push({}),10)-1,c.data("jstree_instance_id",i).addClass("jstree jstree-"+i),this.data=f,this.get_index=function(){return i},this.get_container=function(){return c},this.get_container_ul=function(){return c.children("ul:eq(0)")},this.get_settings=function(b){return b?e:a.extend(!0,{},e)},this.__trigger=function(a,b){if(!a)return;b||(b={}),typeof a=="string"&&(a=a.replace(".jstree","")+".jstree"),b.inst=this,this.get_container().triggerHandler(a,b)},b[i]=this,a.each(h,function(a,c){d[c]&&d[c].__construct.apply(b[i])}),this.__trigger("__construct"),a.jstree._focus(i),this},__destruct:function(e){e=a.jstree._reference(e);if(!e)return!1;var f=e.get_settings(),g=e.get_index(),h=0;if(c===g){for(h in b)if(b.hasOwnProperty(h)&&h!==g){a.jstree._focus(h);break}c===g&&a.jstree._focus(!1)}return a.each(f.plugins,function(a,b){try{d[b].__destruct.apply(e)}catch(c){}}),e.__trigger("__destruct"),e.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree_instance_id").find("[class^='jstree']").andSelf().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")}),a(document).unbind(".jstree-"+g).undelegate(".jstree-"+g),delete b[g],!0},__call:function(b,c,d){b=a.jstree._reference(b);if(!b||!a.isFunction(b[c]))return;return b[c].apply(b,d)},_reference:function(c){if(b[c])return b[c];var d=a(c);return!d.length&&typeof c=="string"&&(d=a("#"+c)),d.length?b[d.closest(".jstree").data("jstree_instance_id")]||null:null},_focused:function(){return b[c]||null},_focus:function(d){return d===!1?(b[c].get_container().removeClass("jstree-focused"),b[c].__trigger("_defocus"),c=-1,!1):(d=a.jstree._reference(d),!d||d.get_index()===c?!1:(c!==-1&&(b[c].get_container().removeClass("jstree-focused"),b[c].__trigger("_defocus")),c=d.get_index(),d.get_container().addClass("jstree-focused"),d.__trigger("_focus"),!0))},plugin:function(b,c){c=a.extend({},{__construct:a.noop,__destuct:a.noop,_fn:{},defaults:!1},c),d[b]=c,a.jstree.defaults[b]=c.defaults,a.each(c._fn,function(c,d){d.plugin=b,d.old=e[c],e[c]=function(){var b,e=d,f=Array.prototype.slice.call(arguments),g=new a.Event("before.jstree"),h=this.get_settings(!0).plugins;do{if(e&&e.plugin&&a.inArray(e.plugin,h)!==-1)break;e=e.old}while(e);if(!e)return;if(c.indexOf("_")===0)b=e.apply(this,f);else{b=this.__trigger(g,{func:c,args:f,plugin:e.plugin});if(b===!1)return;b=e.apply(a.extend({},this,{__callback:function(a){return this.__trigger(c,{args:f,rslt:a,plugin:e.plugin}),a},__call_old:function(a){return e.old.apply(this,a?Array.prototype.slice.call(arguments,1):f)}}),f)}return b},e[c].old=d.old,e[c].plugin=b})},defaults:{plugins:[]}},a.fn.jstree=function(b){var c=typeof b=="string",d=Array.prototype.slice.call(arguments,1),e=this;return this.each(function(){if(c){var f=a.jstree.__call(this,b,d);if(typeof f!="undefined"&&(b.indexOf(!1)||f!==!0&&f!==!1))return e=f,!1}else c=new a.jstree.__construct(this,b)}),e},e=a.jstree.__construct.prototype,a.expr[":"].jstree=function(b,c,d){return typeof a(b).data("jstree_instance_id")!="undefined"}})(jQuery),function(a){var b=!1,c=!1;a(function(){a.jstree.SCROLLBAR_WIDTH=a.vakata.get_scrollbar_width()}),a.jstree.plugin("core",{__construct:function(){this.data.core.rtl=this.get_container().css("direction")==="rtl",this.data.core.rtl&&this.get_container().addClass("jstree-rtl"),this.data.core.ready=!1,this.get_container().bind("__construct.jstree",a.proxy(function(){setTimeout(a.proxy(function(){this&&this.init()},this),0)},this)).bind("before.jstree",a.proxy(function(a,b){if(!/^is_locked|unlock$/.test(b.func)&&this.data.core.locked)return a.stopImmediatePropagation(),!1},this)).bind("create_node.jstree",a.proxy(function(a,b){this.clean_node(b.rslt.obj)},this)).bind("load_node.jstree",a.proxy(function(a,b){this.clean_node(b.rslt.obj===-1?this.get_container_ul().children("li"):b.rslt.obj.find("> ul > li")),!this.data.core.ready&&!this.get_container_ul().find(".jstree-loading:eq(0)").length&&(this.data.core.ready=!0,this.__trigger("__ready"))},this)).bind("__loaded.jstree",a.proxy(function(a,b){b.inst.get_container_ul().children("li").each(function(){b.inst.correct_node(this)})},this)).bind("open_node.jstree",a.proxy(function(a,b){b.rslt.obj.find("> ul > li").each(function(){b.inst.correct_node(this)})},this)).bind("mousedown.jstree",a.proxy(function(){a.jstree._focus(this.get_index())},this)).bind("dblclick.jstree",function(){if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){var a=window.getSelection();try{a.removeAllRanges(),a.collapse()}catch(b){}}}).delegate("li > ins","click.jstree",a.proxy(function(a){this.toggle_node(a.target)},this))},__destruct:function(){},defaults:{strings:!1},_fn:{_get_string:function(b){var c=this.get_settings(!0).core.strings;return a.isFunction(c)?c.call(this,b):c&&c[b]?c[b]:b},init:function(){this.data.core.original_container_html=this.get_container().find(" > ul > li").clone(!0),this.data.core.original_container_html.find("li").andSelf().contents().filter(function(){return this.nodeType===3&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.get_container().html("<ul><li class='jstree-loading'><a href='#'>"+this._get_string("Loading ...")+"</a></li></ul>"),this.clean_node(-1),this.data.core.li_height=this.get_container_ul().children("li:eq(0)").height()||18,this.load_node(-1,function(){this.__trigger("__loaded")})},lock:function(){this.data.core.locked=!0,this.get_container().addClass("jstree-locked"),this.__callback()},unlock:function(){this.data.core.locked=!1,this.get_container().removeClass("jstree-locked"),this.__callback()},is_locked:function(){return this.data.core.locked},get_node:function(b){var c=a(b,this.get_container());return c.is(".jstree")||b===-1?-1:(c=c.closest("li",this.get_container()),c.length?c:!1)},get_next:function(a,b){return a=this.get_node(a),a===-1?this.get_container_ul().children("li:eq(0)"):!a||!a.length?!1:b?a.nextAll("li").size()>0?a.nextAll("li:eq(0)"):!1:a.hasClass("jstree-open")?a.find("li:eq(0)"):a.nextAll("li").size()>0?a.nextAll("li:eq(0)"):a.parentsUntil(".jstree","li").next("li").eq(0)},get_prev:function(a,b){a=this.get_node(a);if(a===-1)return this.get_container().find("> ul > li:last-child");if(!a||!a.length)return!1;if(b)return a.prevAll("li").length>0?a.prevAll("li:eq(0)"):!1;if(a.prev("li").length){a=a.prev("li").eq(0);while(a.hasClass("jstree-open"))a=a.children("ul:eq(0)").children("li:last");return a}var c=a.parentsUntil(".jstree","li:eq(0)");return c.length?c:!1},get_parent:function(a){a=this.get_node(a);if(a===-1||!a||!a.length)return!1;var b=a.parentsUntil(".jstree","li:eq(0)");return b.length?b:-1},get_children:function(a){return a=this.get_node(a),a===-1?this.get_container_ul().children("li"):!a||!a.length?!1:a.find("> ul > li")},is_parent:function(a){return a=this.get_node(a),a&&a!==-1&&(a.find("> ul > li:eq(0)").length||a.hasClass("jstree-closed"))},is_loaded:function(a){return a=this.get_node(a),a&&(a===-1&&!this.get_container().find("> ul > li.jstree-loading").length||a!==-1&&!a.hasClass("jstree-loading")&&(a.find("> ul > li").length||a.hasClass("jstree-leaf")))},is_loading:function(a){return a=this.get_node(a),a&&(a===-1&&this.get_container().find("> ul > li.jstree-loading").length||a!==-1&&a.hasClass("jstree-loading"))},is_open:function(a){return a=this.get_node(a),a&&a!==-1&&a.hasClass("jstree-open")},is_closed:function(a){return a=this.get_node(a),a&&a!==-1&&a.hasClass("jstree-closed")},is_leaf:function(a){return a=this.get_node(a),a&&a!==-1&&a.hasClass("jstree-leaf")},load_node:function(b,c){return b=this.get_node(b),b?(b!==-1&&b.addClass("jstree-loading"),this._load_node(b,a.proxy(function(a){b!==-1&&b.removeClass("jstree-loading"),this.__callback({obj:b,status:a}),c&&c.call(this,b,a)},this)),!0):(c.call(this,b,!1),!1)},_load_node:function(a,b){a===-1&&this.get_container_ul().empty().append(this.data.core.original_container_html.clone(!0)),b.call(null,!0)},open_node:function(b,c,d){b=this.get_node(b);if(b===-1||!b||!b.length)return!1;if(!this.is_closed(b))return c&&c.call(this,b,!1),!1;if(!this.is_loaded(b))this.load_node(b,function(a,b){return b?this.open_node(a,c,d):c?c.call(this,a,!1):!1});else{var e=this;b.children("ul").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").children("ul").stop(!0,!0).slideDown(a.jstree.IS_IE6?0:d,function(){this.style.display="",e.__trigger("__after_open",{rslt:{obj:b}})}),c&&c.call(this,b,!0),this.__callback({obj:b})}},close_node:function(b,c){b=this.get_node(b);if(!b||!b.length||!this.is_open(b))return!1;var d=this;b.children("ul").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").children("ul").stop(!0,!0).slideUp(a.jstree.IS_IE6?0:c,function(){this.style.display="",d.__trigger("__after_close",{rslt:{obj:b}})}),this.__callback({obj:b})},toggle_node:function(a){if(this.is_closed(a))return this.open_node(a);if(this.is_open(a))return this.close_node(a)},open_all:function(a,b,c){a=a?this.get_node(a):-1,a=!a||a===-1?this.get_container_ul():a,c=c||a;var d=this;a=this.is_closed(a)?a.find("li.jstree-closed").andSelf():a.find("li.jstree-closed"),a.each(function(){d.open_node(this,d.is_loaded(this)?!1:function(a){this.open_all(a,b,c)},b||0)}),c.find("li.jstree-closed").length===0&&this.__callback({obj:c})},close_all:function(a,b){a=a?this._get_node(a):-1;var c=!a||a===-1?this.get_container_ul():a,d=this;c=this.is_open(c)?c.find("li.jstree-open").andSelf():c.find("li.jstree-open"),c.each(function(){d.close_node(this,b||0)}),this.__callback({obj:a})},clean_node:function(b){b=this.get_node(b),b=!b||b===-1?this.get_container().find("li"):b.find("li").andSelf();var c=this;return b.each(function(){var b=a(this),d=b.data("jstree"),e=d&&d.opened||b.hasClass("jstree-open")?"open":d&&d.closed||b.children("ul").length?"closed":"leaf";d&&d.opened&&delete d.opened,d&&d.closed&&delete d.closed,b.removeClass("jstree-open jstree-closed jstree-leaf jstree-last"),b.children("a").length?a.trim(b.children("a").attr("href"))||b.children("a").attr("href","#"):(b.contents().filter(function(){return this.nodeType===3||this.tagName!=="UL"}).wrapAll('<a href="#"></a>'),b.children("a").html(b.children("a").html().replace(/[\s\t\n]+$/,""))),b.children("ins.jstree-ocl").length||b.prepend("<ins class='jstree-icon jstree-ocl'>&#160;</ins>"),b.is(":last-child")&&b.addClass("jstree-last");switch(e){case"leaf":b.addClass("jstree-leaf");break;case"closed":b.addClass("jstree-open"),c.close_node(b,0);break;case"open":b.addClass("jstree-closed"),c.open_node(b,!1,0)}})},correct_node:function(b,c){return b=this.get_node(b),!b||b===-1&&!c?!1:(b===-1?b=this.get_container().find("li"):b=c?b.find("li").andSelf():b,b.each(function(){var b=a(this);switch(!0){case b.hasClass("jstree-open")&&!b.find("> ul > li").length:b.removeClass("jstree-open").addClass("jstree-leaf").children("ul").remove();break;case b.hasClass("jstree-leaf")&&!!b.find("> ul > li").length:b.removeClass("jstree-leaf").addClass("jstree-closed")}b[b.is(":last-child")?"addClass":"removeClass"]("jstree-last")}),b)},scroll_to_node:function(b){var c=this.get_container()[0],d;if(c.scrollHeight>c.offsetHeight){b=this.get_node(b);if(!b||b===-1||!b.length||!b.is(":visible"))return;d=b.offset().top-this.get_container().offset().top,d<0&&(c.scrollTop=c.scrollTop+d-1),d+this.data.core.li_height+(c.scrollWidth>c.offsetWidth?a.jstree.SCROLLBAR_WIDTH:0)>c.offsetHeight&&(c.scrollTop=c.scrollTop+(d-c.offsetHeight+this.data.core.li_height+1+(c.scrollWidth>c.offsetWidth?a.jstree.SCROLLBAR_WIDTH:0)))}},get_state:function(){var a={open:[],scroll:{left:this.get_container().scrollLeft(),top:this.get_container().scrollTop()}};return this.get_container_ul().find(".jstree-open").each(function(){this.id&&a.open.push(this.id)}),a},set_state:function(b,c){if(b){if(a.isArray(b.open)){var d=!0,e=this;return this.close_all(),a.each(b.open.concat([]),function(c,f){f=document.getElementById(f),f&&(e.is_loaded(f)?(e.is_closed(f)&&e.open_node(f,!1,0),a.vakata.array_remove(b.open,c)):(e.open_node(f,a.proxy(function(){this.set_state(b)},e),0),d=!1))}),d&&(delete b.open,this.set_state(b,c)),!1}return b.scroll?(b.scroll&&typeof b.scroll.left!="undefined"&&this.get_container().scrollLeft(b.scroll.left),b.scroll&&typeof b.scroll.top!="undefined"&&this.get_container().scrollTop(b.scroll.top),delete b.scroll,delete b.open,this.set_state(b,c),!1):a.isEmptyObject(b)?(c&&c.call(this),this.__callback(),!1):!0}return!1},refresh:function(){this.data.core.state=this.get_state(),this.load_node(-1,function(b,c){c&&this.set_state(a.extend(!0,{},this.data.core.state),function(){this.__trigger("refresh")}),this.data.core.state=null})},get_text:function(a,b){return a=this.get_node(a),!a||a===-1||!a.length?!1:(a=a.children("a:eq(0)").clone(),a.children(".jstree-icon").remove(),a[b?"text":"html"]())},set_text:function(a,b){a=this.get_node(a);if(!a||a===-1||!a.length)return!1;a=a.children("a:eq(0)");var c=a.children("INS").clone();return a.html(b).prepend(c),this.__callback({obj:a,text:b}),!0},parse_json:function(b){var c,d,e,f;if(a.isArray(b))return e=a("<ul />"),f=this,a.each(b,function(a,b){e.append(f.parse_json(b))}),e;typeof b=="undefined"&&(b={}),typeof b=="string"&&(b={title:b}),b.li_attr||(b.li_attr={}),b.a_attr||(b.a_attr={}),b.a_attr.href||(b.a_attr.href="#"),b.title||(b.title=this._get_string("New node")),c=a("<li />").attr(b.li_attr),d=a("<a />").attr(b.a_attr).html(b.title),e=a("<ul />"),b.data&&!a.isEmptyObject(b.data)&&c.data(b.data);if(b.children===!0||a.isArray(b.children)||c.data("jstree")&&a.isArray(c.data("jstree").children))c.data("jstree")||c.data("jstree",{}),c.data("jstree").closed=!0;return c.append(d),a.isArray(b.children)&&(a.each(b.children,a.proxy(function(a,b){e.append(this.parse_json(b))},this)),c.append(e)),c},get_json:function(b,c){b=typeof b!="undefined"?this.get_node(b):!1,!c&&(!b||b===-1)&&(b=this.get_container_ul().children("li"));var d,e,f={},g={},h={};return!b||!b.length?!1:b.length>1||!c?(d=[],e=this,b.each(function(){d.push(e.get_json(a(this),!0))}),d):(h=a.vakata.attributes(b,!0),a.each(h,function(b,c){if(b==="id")return f[b]=c,!0;c=a.trim(c.replace(/\bjstree[^ ]*/ig,"").replace(/\s+$/ig," ")),c.length&&(f[b]=c)}),h=a.vakata.attributes(b.children("a"),!0),a.each(h,function(b,c){if(b==="id")return g[b]=c,!0;c=a.trim(c.replace(/\bjstree[^ ]*/ig,"").replace(/\s+$/ig," ")),c.length&&(g[b]=c)}),d={title:this.get_text(b),data:a.extend(!0,{},b.data()||{}),children:!1,li_attr:f,a_attr:g},d.data.jstree||(d.data.jstree={}),this.is_open(b)&&(d.data.jstree.opened=!0),this.is_closed(b)&&(d.data.jstree.closed=!0),b=b.find("> ul > li"),b.length&&(d.children=[],e=this,b.each(function(){d.children.push(e.get_json(a(this),!0))})),d)},create_node:function(a,b,c,d,e){a=this.get_node(a),c=typeof c=="undefined"?"last":c;if(a!==-1&&!a.length)return!1;if(!c.match(/^(before|after)$/)&&!e&&!this.is_loaded(a))return this.load_node(a,function(){this.create_node(a,b,c,d,!0)});var f=this.parse_json(b),g=a===-1?this.get_container():a;a===-1&&(c==="before"&&(c="first"),c==="after"&&(c="last"));switch(c){case"before":c=a.index(),a=this.get_parent(a);break;case"after":c=a.index()+1,a=this.get_parent(a);break;case"inside":case"first":c=0;break;case"last":c=g.children("ul").children("li").length;break;default:c||(c=0)}return this.check("create_node",f,a,c)?(g=a===-1?this.get_container():a,g.children("ul").length||g.append("<ul />"),g.children("ul").children("li").eq(c).length?g.children("ul").children("li").eq(c).before(f):g.children("ul").append(f),this.correct_node(a,!0),d&&d.call(this,f),this.__callback({obj:f,parent:a,position:f.index()}),f):!1},rename_node:function(a,b){a=this.get_node(a);var c=this.get_text(a);if(!this.check("rename_node",a,this.get_parent(a),b))return!1;a&&a.length&&(this.set_text(a,b),this.__callback({obj:a,title:b,old:c}))},delete_node:function(a){a=this.get_node(a);if(!a||a===-1||!a.length)return!1;var b=this.get_parent(a),c=this.get_prev(a);return this.check("delete_node",a,b,a.index())?(a=a.detach(),this.correct_node(b),this.correct_node(c),this.__callback({obj:a,prev:c,parent:b}),a):!1},check:function(a,b,c,d){switch(a){case"create_node":break;case"rename_node":break;case"move_node":var e=c===-1?this.get_container():c;e=e.children("ul").children("li");if(e.length&&e.index(b)!==-1&&(d===b.index()||d===b.index()+1))return!1;if(c!==-1&&c.parentsUntil(".jstree","li").andSelf().index(b)!==-1)return!1;break;case"copy_node":break;case"delete_node":}return!0},move_node:function(b,c,d,e,f){b=this.get_node(b),c=this.get_node(c),d=typeof d=="undefined"?0:d;if(!b||b===-1||!b.length)return!1;if(c!==-1&&!c.length)return!1;if(!d.toString().match(/^(before|after)$/)&&!f&&!this.is_loaded(c))return this.load_node(c,function(){this.move_node(b,c,d,e,!0)});var g=this.get_parent(b),h=!d.toString().match(/^(before|after)$/)||c===-1?c:this.get_parent(c),i=a.jstree._reference(b),j=c===-1?this:a.jstree._reference(c),k=i.get_index()!==j.get_index();h===-1&&(c=j.get_container(),d==="before"&&(d="first"),d==="after"&&(d="last"));switch(d){case"before":d=c.index();break;case"after":d=c.index()+1;break;case"inside":case"first":d=0;break;case"last":d=c.children("ul").children("li").length;break;default:d||(d=0)}return this.check("move_node",b,h,d)?(c.children("ul").length||c.append("<ul />"),c.children("ul").children("li").eq(d).length?c.children("ul").children("li").eq(d).before(b):c.children("ul").append(b),k&&(b.find(".jstree-icon, .jstree-ocl").remove(),this.clean_node(b)),i.correct_node(g,!0),j.correct_node(h,!0),e&&e.call(this,b,h,b.index()),this.__callback({obj:b,parent:h,position:b.index(),old_parent:g,is_multi:k,old_instance:i,new_instance:j}),!0):!1},copy_node:function(b,c,d,e,f){b=this.get_node(b),c=this.get_node(c),d=typeof d=="undefined"?"last":d;if(!b||b===-1||!b.length)return!1;if(c!==-1&&!c.length)return!1;if(!d.toString().match(/^(before|after)$/)&&!f&&!this.is_loaded(c))return this.load_node(c,function(){this.copy_node(b,c,d,e,!0)});var g=b,h=this.get_parent(b),i=!d.toString().match(/^(before|after)$/)||c===-1?c:this.get_parent(c),j=a.jstree._reference(b),k=c===-1?this:a.jstree._reference(c),l=j.get_index()!==k.get_index();b=b.clone(!0),b.find("*[id]").andSelf().each(function(){this.id&&(this.id="copy_"+this.id)}),i===-1&&(c=k.get_container(),d==="before"&&(d="first"),d==="after"&&(d="last"));switch(d){case"before":d=c.index();break;case"after":d=c.index()+1;break;case"inside":case"first":d=0;break;case"last":d=c.children("ul").children("li").length;break;default:d||(d=0)}return this.check("copy_node",g,i,d)?(c.children("ul").length||c.append("<ul />"),c.children("ul").children("li").eq(d).length?c.children("ul").children("li").eq(d).before(b):c.children("ul").append(b),l&&b.find(".jstree-icon, .jstree-ocl").remove(),k.clean_node(b),k.correct_node(i,!0),e&&e.call(this,b,i,b.index(),g),this.__callback({obj:b,parent:i,old_parent:h,position:b.index(),original:g,is_multi:l,old_instance:j,new_instance:k}),!0):!1},cut:function(a){a=this.get_node(a);if(!a||a===-1||!a.length)return!1;b=a,c="move_node",this.__callback({obj:a})},copy:function(a){a=this.get_node(a);if(!a||a===-1||!a.length)return!1;b=a,c="copy_node",this.__callback({obj:a})},can_paste:function(){return c!==!1&&b!==!1},paste:function(a){a=this.get_node(a);if(!a||!c||!c.match(/^(copy_node|move_node)$/)||!b)return!1;this[c](b,a),this.__callback({obj:a,nodes:b,mode:c}),b=!1,c=!1},edit:function(b,c){b=this.get_node(b);if(!b||b===-1||!b.length)return!1;b.parentsUntil(".jstree",".jstree-closed").each(a.proxy(function(a,b){this.open_node(b,!1,0)},this));var d=this.data.core.rtl,e=this.get_container().width(),f=b.children("a:eq(0)"),g=b.children("ins"),h=f.children("ins"),i=g.width()*g.length,j=h.width()*h.length,k=typeof c=="string"?c:this.get_text(b),l=a("<div />",{css:{position:"absolute",top:"-200px",left:d?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),m=b.css("position","relative").append(a("<input />",{value:k,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver",position:"absolute",left:d?"auto":i+j+4+"px",right:d?i+j+4+"px":"auto",top:"0px",height:this.data.core.li_height-2+"px",lineHeight:this.data.core.li_height-2+"px",width:"150px"},blur:a.proxy(function(){var a=b.children(".jstree-rename-input"),c=a.val();c===""&&(c=k),l.remove(),a.remove(),this.rename_node(b,c),b.css("position","")},this),keyup:function(a){var b=a.keyCode||a.which;if(b===27){this.value=k,this.blur();return}if(b===13){this.blur();return}m.width(Math.min(l.text("pW"+this.value).width(),e))},keypress:function(a){var b=a.keyCode||a.which;if(b===13)return!1}})).children(".jstree-rename-input"),n={fontFamily:f.css("fontFamily")||"",fontSize:f.css("fontSize")||"",fontWeight:f.css("fontWeight")||"",fontStyle:f.css("fontStyle")||"",fontStretch:f.css("fontStretch")||"",fontVariant:f.css("fontVariant")||"",letterSpacing:f.css("letterSpacing")||"",wordSpacing:f.css("wordSpacing")||""};this.set_text(b,""),l.css(n),m.css(n).width(Math.min(l.text("pW"+m[0].value).width(),e))[0].select()}}}),a(function(){var b=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree .jstree-icon { display:inline-block; text-decoration:none; margin:0; padding:0; vertical-align:top; } .jstree .jstree-ocl { width:18px; height:18px; text-align:center; line-height:18px; cursor:default; vertical-align:top; } .jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; padding:1px 2px; margin:0; } .jstree a:focus { outline: none; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } ";if(a.jstree.IS_IE6){try{document.execCommand("BackgroundImageCache",!1,!0)}catch(c){}b+=".jstree li { height:18px; margin-left:0; margin-right:0; } .jstree li li { margin-left:18px; } .jstree-rtl li li { margin-left:0px; margin-right:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } "}a.jstree.IS_IE7&&(b+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } "),a.jstree.IS_FF2&&(b+=".jstree .jstree-icon { display:-moz-inline-box; } .jstree li { line-height:12px; } .jstree a { display:-moz-inline-box; } "),a.vakata.css.add_sheet({str:b,title:"jstree"})})}(jQuery)}(),function(a){a.jstree.plugin("checkbox",{__construct:function(){this.get_container().bind("__construct.jstree",a.proxy(function(){},this)).bind("move_node.jstree, copy_node.jstree",function(b,c){c.rslt.old_instance&&c.rslt.old_parent&&a.isFunction(c.rslt.old_instance.checkbox_repair)&&c.rslt.old_instance.checkbox_repair(c.rslt.old_parent),c.rslt.new_instance&&a.isFunction(c.rslt.new_instance.checkbox_repair)&&c.rslt.new_instance.checkbox_repair(c.rslt.parent)}).bind("delete_node.jstree",function(a,b){this.checkbox_repair(b.rslt.parent)}).delegate("a","click.jstree",a.proxy(function(a){a.preventDefault(),a.currentTarget.blur();var b=this.get_node(a.currentTarget);this.toggle_check(b)},this))},defaults:{three_state:!0},_fn:{check_node:function(a){a=this.get_node(a),a.find(" > a > .jstree-checkbox").removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked").children(":checkbox").prop("checked",!0).prop("undermined",!1),this.checkbox_repair(a)},uncheck_node:function(a){a=this.get_node(a),a.find(" > a > .jstree-checkbox").removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked").children(":checkbox").prop("checked",!1).prop("undermined",!1),this.checkbox_repair(a)},toggle_check:function(a){a=a.find(" > a > .jstree-checkbox").removeClass("jstree-undetermined").toggleClass("jstree-checked"),a.hasClass("jstree-checked")?a.children(":checkbox").prop("checked",!0).prop("undermined",!1):a.addClass("jstree-unchecked").children(":checkbox").prop("checked",!1).prop("undermined",!1),this.checkbox_repair(this.get_node(a))},uncheck_all:function(b){var c=b?a(b).find(".jstree-checked").closest("li"):this.get_container().find(".jstree-checked").closest("li");c.children(".jstree-checkbox").removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked").children(":checkbox").prop("checked",!1).prop("undermined",!1),this.__callback({obj:c})},checkbox_repair:function(b){if(!this.get_settings(!0).checkbox.three_state)return!1;if(!b||b===-1)b=this.get_container_ul().children("li");b.length>1&&b.each(a.proxy(function(b,c){this.checkbox_repair(a(c))},this));var c=b.find(" > a > .jstree-checkbox"),d=!0,e,f,g,h,i;!c.hasClass("jstree-checked")&&!c.hasClass("jstree-unchecked")&&(e=this.get_parent(b),e&&e!==-1&&e.length&&e.find("> a > .jstree-checked").length?c.addClass("jstree-checked"):c.addClass("jstree-unchecked"),d=!1),c.hasClass("jstree-checked")&&b.find(".jstree-checkbox").removeClass("jstree-undetermined jstree-unchecked").addClass("jstree-checked").children(":checkbox").prop("checked",!0).prop("undermined",!1),c.hasClass("jstree-unchecked")&&b.find(".jstree-checkbox").removeClass("jstree-undetermined jstree-checked").addClass("jstree-unchecked").children(":checkbox").prop("checked",!1).prop("undermined",!1);while(d){b=this.get_parent(b);if(!b||b===-1||!b.length)return;f=b.find(" > ul > li"),g=f.find(" > a > .jstree-checked").length,h=f.find(" > a > .jstree-unchecked").length,i=f.find(" > a > .jstree-undetermined").length,f=f.length;if(g+h+i<f)return;if(h===f){c=b.find(" > a > .jstree-checkbox");if(c.hasClass("jstree-unchecked"))return;c.removeClass("jstree-undetermined jstree-checked").addClass("jstree-unchecked").children(":checkbox").prop("checked",!1).prop("undermined",!1);continue}if(g===f){c=b.find(" > a > .jstree-checkbox");if(c.hasClass("jstree-checked"))return;c.removeClass("jstree-undetermined jstree-unchecked").addClass("jstree-checked").children(":checkbox").prop("checked",!0).prop("undermined",!1);continue}b.parentsUntil(".jstree","li").andSelf().find(" > a > .jstree-checkbox").removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined").children(":checkbox").prop("checked",!1).prop("undetermined",!0);return}},clean_node:function(b){b=this.__call_old();var c=this;return b=b.each(function(){var b=a(this),d=b.data("jstree");b.find(" > a > .jstree-checkbox").remove(),b.children("a").prepend("<ins class='jstree-icon jstree-checkbox "+(d&&d.checkbox&&d.checkbox.checked===!0?"jstree-checked":"")+(d&&d.checkbox&&d.checkbox.checked===!1||!c.get_settings(!0).checkbox.three_state?"jstree-unchecked":"")+" '><input class='jstree-check' type='checkbox' "+(d&&d.checkbox&&d.checkbox.checked?' checked="checked" ':"")+" name='"+(d&&d.checkbox&&typeof d.checkbox.name!="undefined"?d.checkbox.name:"jstree[]")+"' value='"+(d&&d.checkbox&&typeof d.checkbox.value!="undefined"?d.checkbox.value:b.attr("id"))+"' /></ins>")}),c.checkbox_repair(b),b},get_state:function(){var a=this.__call_old();return a.checked=[],this.get_container().find(".jstree-checked").closest("li").each(function(){this.id&&a.checked.push(this.id)}),a},set_state:function(b,c){if(this.__call_old()){if(b.checkbox){var d=this;return this.uncheck_all(),a.each(b.checkbox,function(a,b){d.check_node(document.getElementById(b))}),this.checkbox_repair(),delete b.checkbox,this.set_state(b,c),!1}return!0}return!1},get_json:function(a,b){var c=this.__call_old(),d;return b&&(d=a.find("> a > ins > :checkbox"),c.data.jstree.checkbox={},c.data.jstree.checkbox.checked=d.parent().hasClass("jstree-checked"),d.attr("name")!=="jstree[]"&&(c.data.checkbox.name=d.attr("name")),d.val()!==a.attr("id")&&(c.data.checkbox.value=d.val())),c}}}),a(function(){var b=".jstree a > .jstree-checkbox { height:16px; width:16px; margin-right:1px; } .jstree-rtl a > .jstree-checkbox { margin-right:0; margin-left:1px; } .jstree .jstree-check { margin:0; padding:0; border:0; display:inline; vertical-align:text-bottom; } ";a.jstree.IS_IE6&&(b+=".jstree li a .jstree-checkbox { height:16px; width:16px; background:transparent; margin-right:1px; } .jstree-rtl li a .jstree-checkbox { margin-right:0; margin-left:1px; } "),a.vakata.css.add_sheet({str:b,title:"jstree"})}),a.jstree.defaults.plugins.push("checkbox")}(jQuery),function(a){a.jstree.plugin("contextmenu",{__construct:function(){this.get_container().delegate("a","contextmenu.jstree",a.proxy(function(a){a.preventDefault(),this.is_loading(a.currentTarget)||this.show_contextmenu(a.currentTarget,a.pageX,a.pageY)},this)).delegate("a","click.jstree",a.proxy(function(a){this.data.contextmenu.visible&&this._hide_contextmenu()},this)),a(document).bind("context_hide.vakata",a.proxy(function(){this.data.contextmenu=!1},this))},__destruct:function(){this.data.contextmenu&&this._hide_contextmenu()},defaults:{select_node:!0,show_at_node:!0,items:function(b){return{create:{separator_before:!1,separator_after:!0,label:"Create",action:function(b){var c=a.jstree._reference(b.reference),d=c.get_node(b.reference);c.create_node(d,{},"last",function(a){setTimeout(function(){c.edit(a)},0)})}},rename:{separator_before:!1,separator_after:!1,label:"Rename",action:function(b){var c=a.jstree._reference(b.reference),d=c.get_node(b.reference);c.edit(d)}},remove:{separator_before:!1,icon:!1,separator_after:!1,label:"Delete",action:function(b){var c=a.jstree._reference(b.reference),d=c.get_node(b.reference);c.delete_node(d)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(b){var c=a.jstree._reference(b.reference),d=c.get_node(b.reference);c.cut(d)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(b){var c=a.jstree._reference(b.reference),d=c.get_node(b.reference);c.copy(d)}},paste:{separator_before:!1,icon:!1,_disabled:!this.can_paste(),separator_after:!1,label:"Paste",action:function(b){var c=a.jstree._reference(b.reference),d=c.get_node(b.reference);c.paste(d)}}}}}}},_fn:{show_contextmenu:function(b,c,d){b=this.get_node(b);var e=this.get_settings().contextmenu,f=b.children("a:visible:eq(0)"),g=!1,h=!1;if(e.show_at_node||typeof c=="undefined"||typeof d=="undefined")g=f.offset(),c=g.left,d=g.top+this.data.core.li_height;e.select_node&&this.data.ui&&!this.is_selected(b)&&(this.deselect_all(),this.select_node(b)),h=b.data("jstree")&&b.data("jstree").contextmenu?b.data("jstree").contextmenu:e.items,a.isFunction(h)&&(h=h.call(this,b)),a(document).one("context_show.vakata",a.proxy(function(b,c){var d="jstree-contextmenu";this.data.themes.theme&&(d+=" jstree-"+this.data.themes.theme+"-contextmenu"),a(c.element).addClass(d)},this)),this.data.contextmenu.visible=!0,a.vakata.context.show(f,{x:c,y:d},h),this.__callback({obj:b,x:c,y:d})}}}),a.jstree.defaults.plugins.push("contextmenu")}(jQuery),function(a){a.jstree.plugin("dnd",{__construct:function(){this.get_container().delegate("a","mousedown",a.proxy(function(b){var c=this.get_node(b.target);if(c&&c!==-1&&c.length&&b.which===1)return this.get_container().trigger("mousedown.jstree"),a.vakata.dnd.start(b,{jstree:!0,origin:this,obj:c},'<div id="jstree-dnd" class="'+(this.data.themes?"jstree-"+this.get_theme():"")+'"><ins class="jstree-icon jstree-er">&#160;</ins>'+this.get_text(b.currentTarget,!0)+'<ins class="jstree-copy" style="display:none;">+</ins></div>')},this))},defaults:{copy_modifier:"ctrl",open_timeout:500}}),a(function(){var b=!1,c=!1,d=a('<div id="jstree-marker">&#160;</div>').hide().appendTo("body");a(document).bind("dnd_start.vakata",function(a,c){b=!1}).bind("dnd_move.vakata",function(e,f){c&&clearTimeout(c);if(!f.data.jstree)return;if(f.event.target.id&&f.event.target.id==="jstree-marker")return;var g=a.jstree._reference(f.event.target),h=!1,i=!1,j=!1,k,l,m,n,o,p;if(g&&g.data&&g.data.dnd){d.attr("class",g.data.themes?"jstree-"+g.get_theme():""),f.helper.children().attr("class",g.data.themes?"jstree-"+g.get_theme():"").find(".jstree-copy:eq(0)")[f.event[f.data.origin.get_settings().dnd.copy_modifier+"Key"]?"show":"hide"]();if(f.event.target===g.get_container()[0]||f.event.target===g.get_container_ul()[0]){if(g.check(f.event[f.data.origin.get_settings().dnd.copy_modifier+"Key"]?"copy_node":"move_node",f.data.obj,-1,"last")){b={ins:g,par:-1,pos:"last"},d.hide(),f.helper.find(".jstree-icon:eq(0)").removeClass("jstree-er").addClass("jstree-ok");return}}else{h=a(f.event.target).closest("a");if(h&&h.length&&h.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")){i=h.offset(),j=f.event.pageY-i.top,m=h.height(),j<m/3?p=["b","i","a"]:j>m-m/3?p=["a","i","b"]:p=j>m/2?["i","a","b"]:["i","b","a"],a.each(p,function(a,e){switch(e){case"b":k=i.left-6,l=i.top-5,n=g.get_parent(h),o=h.parent().index();break;case"i":k=i.left-2,l=i.top-5+m/2+1,n=h.parent(),o=0;break;case"a":k=i.left-6,l=i.top-5+m+2,n=g.get_parent(h),o=h.parent().index()+1}if(g.check(f.event[f.data.origin.get_settings().dnd.copy_modifier+"Key"]?"copy_node":"move_node",f.data.obj,n,o))return e==="i"&&h.parent().is(".jstree-closed")&&g.get_settings(!0).dnd.open_timeout&&(c=setTimeout(function(a,b){return function(){a.open_node(b)}}(g,h),g.get_settings(!0).dnd.open_timeout)),b={ins:g,par:n,pos:o},d.css({left:k+"px",top:l+"px"}).show(),f.helper.find(".jstree-icon:eq(0)").removeClass("jstree-er").addClass("jstree-ok"),p=!0,!1});if(p===!0)return}}}b=!1,f.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),d.hide()}).bind("dnd_scroll.vakata",function(a,c){if(!c.data.jstree)return;d.hide(),b=!1,c.helper.find(".jstree-icon:eq(0)").removeClass("jstree-ok").addClass("jstree-er")}).bind("dnd_stop.vakata",function(a,e){c&&clearTimeout(c);if(!e.data.jstree)return;d.hide(),b&&b.ins[e.event[e.data.origin.get_settings().dnd.copy_modifier+"Key"]?"copy_node":"move_node"](e.data.obj,b.par,b.pos)}).bind("keyup keydown",function(b,c){c=a.vakata.dnd._get(),c.data&&c.data.jstree&&c.helper.find(".jstree-copy:eq(0)")[b[c.data.origin.get_settings().dnd.copy_modifier+"Key"]?"show":"hide"]()});var e="#jstree-marker { position: absolute; top:0; left:0; margin:0; padding:0; border-right:0; border-top:5px solid transparent; border-bottom:5px solid transparent; border-left:5px solid; width:0; height:0; font-size:0; line-height:0; _border-top-color:pink; _border-botton-color:pink; _filter:chroma(color=pink); } #jstree-dnd { line-height:16px; margin:0; padding:4px; } #jstree-dnd .jstree-icon, #jstree-dnd .jstree-copy { display:inline-block; text-decoration:none; margin:0 2px 0 0; padding:0; width:16px; height:16px; } #jstree-dnd .jstree-ok { background:green; } #jstree-dnd .jstree-er { background:red; } #jstree-dnd .jstree-copy { margin:0 2px 0 2px; }";a.vakata.css.add_sheet({str:e,title:"jstree"})}),a.jstree.defaults.plugins.push("dnd")}(jQuery),function(a){function c(b,c){var d=a.jstree._focused(),e;if(d&&d.data&&d.data.hotkeys&&d.data.hotkeys.enabled){e=d.get_settings(!0).hotkeys[b];if(e)return e.call(d,c)}}if(typeof a.hotkeys=="undefined"&&typeof a.vakata_hotkeys=="undefined")throw"jsTree hotkeys: jQuery hotkeys plugin not included.";var b=[];a.jstree.plugin("hotkeys",{__construct:function(){if(!this.data.ui)throw"jsTree hotkeys: jsTree UI plugin not included.";a.each(this.get_settings(!0).hotkeys,function(d,e){e!==!1&&a.inArray(d,b)===-1&&(a(document).bind("keydown",d,function(a){return c(d,a)}),b.push(d))}),this.get_container().bind("lock.jstree",a.proxy(function(){this.data.hotkeys.enabled&&(this.data.hotkeys.enabled=!1,this.data.hotkeys.revert=!0)},this)).bind("unlock.jstree",a.proxy(function(){this.data.hotkeys.revert&&(this.data.hotkeys.enabled=!0)},this)),this.enable_hotkeys()},defaults:{up:function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this.get_prev(a)),!1},"ctrl+up":function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this.get_prev(a)),!1},"shift+up":function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this.get_prev(a)),!1},down:function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this.get_next(a)),!1},"ctrl+down":function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this.get_next(a)),!1},"shift+down":function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this.get_next(a)),!1},left:function(){var a=this.data.ui.hovered||this.data.ui.last_selected;return a&&(a.hasClass("jstree-open")?this.close_node(a):this.hover_node(this.get_prev(a))),!1},"ctrl+left":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;return a&&(a.hasClass("jstree-open")?this.close_node(a):this.hover_node(this.get_prev(a))),!1},"shift+left":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;return a&&(a.hasClass("jstree-open")?this.close_node(a):this.hover_node(this.get_prev(a))),!1},right:function(){var a=this.data.ui.hovered||this.data.ui.last_selected;return a&&a.length&&(a.hasClass("jstree-closed")?this.open_node(a):this.hover_node(this.get_next(a))),!1},"ctrl+right":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;return a&&a.length&&(a.hasClass("jstree-closed")?this.open_node(a):this.hover_node(this.get_next(a))),!1},"shift+right":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;return a&&a.length&&(a.hasClass("jstree-closed")?this.open_node(a):this.hover_node(this.get_next(a))),!1},space:function(){return this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").click(),!1},"ctrl+space":function(a){return a.type="click",this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(a),!1},"shift+space":function(a){return a.type="click",this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(a),!1}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=!0},disable_hotkeys:function(){this.data.hotkeys.enabled=!1}}}),a.jstree.defaults.plugins.push("hotkeys")}(jQuery),function(a){a.jstree.plugin("html",{defaults:{data:!1,ajax:!1},_fn:{_append_html_data:function(b,c){return c=a(c),!c||!c.length||!c.is("ul, li")?!1:(b=this.get_node(b),b===-1&&(b=this.get_container()),b.length?(b.children("ul").length||b.append("<ul />"),b.children("ul").empty().append(c.is("ul")?c.children("li"):c),!0):!1)},_load_node:function(b,c){var d=!1,e=this.get_settings().html;b=this.get_node(b);if(!b)return!1;switch(!0){case!e.data&&!e.ajax:return b===-1&&this._append_html_data(-1,this.data.core.original_container_html.clone(!0)),c.call(this,!0);case a.isFunction(e.data):return e.data.call(this,b,a.proxy(function(a){return c.call(this,this._append_html_data(b,a))},this));case!!e.data&&!e.ajax||!!e.data&&!!e.ajax&&b===-1:return c.call(this,this._append_html_data(b,e.data));case!e.data&&!!e.ajax||!!e.data&&!!e.ajax&&b!==-1:return e.ajax.success=a.proxy(function(d,e,f){var g=this.get_settings().html.ajax;a.isFunction(g.success)&&(d=g.success.call(this,d,e,f)||d),c.call(this,this._append_html_data(b,d))},this),e.ajax.error=a.proxy(function(b,d,e){var f=this.get_settings().html.ajax;a.isFunction(f.error)&&f.error.call(this,b,d,e),c.call(this,!1)},this),e.ajax.dataType||(e.ajax.dataType="html"),a.isFunction(e.ajax.url)&&(e.ajax.url=e.ajax.url.call(this,b)),a.isFunction(e.ajax.data)&&(e.ajax.data=e.ajax.data.call(this,b)),a.ajax(e.ajax)}}}}),a.jstree.defaults.plugins.push("html")}(jQuery),function(a){a.jstree.plugin("json",{__construct:function(){this.get_container().bind("__after_close.jstree",a.proxy(function(b,c){var d=a(c.rslt.obj);this.get_settings(!0).json.progressive_unload&&(d.data("jstree").children=this.get_json(d)[0].children,d.children("ul").remove())},this))},defaults:{data:!1,ajax:!1,progressive_render:!1,progressive_unload:!1},_fn:{parse_json:function(b){var c=this.get_settings(!0).json;return a.isArray(b.children)&&c.progressive_render&&(b.data||(b.data={}),b.data.jstree||(b.data.jstree={}),b.data.jstree.children=b.children,b.children=!0),this.__call_old(!0,b)},_append_json_data:function(a,b){return a=this.get_node(a),a===-1&&(a=this.get_container()),b=this.parse_json(b),!b||!a.length?!1:(a.children("ul").length||a.append("<ul />"),a.children("ul").empty().append(b.children("li")),!0)},_load_node:function(b,c){var d=!1,e=this.get_settings().json;b=this.get_node(b);if(!b)return!1;switch(!0){case b===-1&&this.get_container().data("jstree")&&a.isArray(this.get_container().data("jstree").children):return d=this.get_container().data("jstree").children,this.get_container().data("jstree").children=null,c.call(this,this._append_json_data(b,d));case b!==-1&&b.length&&b.data("jstree")&&a.isArray(b.data("jstree").children):return d=b.data("jstree").children,b.data("jstree").children=null,c.call(this,this._append_json_data(b,d));case!e.data&&!e.ajax:throw"Neither data nor ajax settings supplied.";case a.isFunction(e.data):return e.data.call(this,b,a.proxy(function(a){return c.call(this,this._append_json_data(b,a))},this));case!!e.data&&!e.ajax||!!e.data&&!!e.ajax&&b===-1:return c.call(this,this._append_json_data(b,e.data));case!e.data&&!!e.ajax||!!e.data&&!!e.ajax&&b!==-1:return e.ajax.success=a.proxy(function(d,e,f){var g=this.get_settings().json.ajax;a.isFunction(g.success)&&(d=g.success.call(this,d,e,f)||d),c.call(this,this._append_json_data(b,d))},this),e.ajax.error=a.proxy(function(b,d,e){var f=this.get_settings().json.ajax;a.isFunction(f.error)&&f.error.call(this,b,d,e),c.call(this,!1)},this),e.ajax.dataType||(e.ajax.dataType="json"),a.isFunction(e.ajax.url)&&(e.ajax.url=e.ajax.url.call(this,b)),a.isFunction(e.ajax.data)&&(e.ajax.data=e.ajax.data.call(this,b)),a.ajax(e.ajax)}}}})}(jQuery),function(a){a.jstree.plugin("sort",{__construct:function(){this.get_container().bind("load_node.jstree",a.proxy(function(a,b){var c=this.get_node(b.rslt.obj);c=c===-1?this.get_container_ul():c.children("ul"),this._sort(c,!0)},this)).bind("rename_node.jstree create_node.jstree",a.proxy(function(a,b){this._sort(b.rslt.obj.parent(),!1)},this)).bind("move_node.jstree copy_node.jstree",a.proxy(function(a,b){var c=b.rslt.parent===-1?this.get_container_ul():b.rslt.parent.children("ul");this._sort(c,!1)},this))},defaults:function(a,b){return this.get_text(a,!0)>this.get_text(b,!0)?1:-1},_fn:{_sort:function(b,c){var d=this.get_settings(!0).sort,e=this;b.append(a.makeArray(b.children("li")).sort(a.proxy(d,e))),b.children("li").each(function(){e.correct_node(this,!1)}),c&&(b.find("> li > ul").each(function(){e._sort(a(this))}),e.correct_node(b.children("li"),!0))}}}),a.jstree.defaults.plugins.push("sort")}(jQuery),function(a){a.jstree.plugin("state",{__construct:function(){if(typeof a.vakata.storage=="undefined")throw"jsTree state plugin: vakata storage helper not included.";this.get_container().bind("__loaded.jstree",a.proxy(function(a,b){this.restore_state()},this)).bind("__ready.jstree",a.proxy(function(b,c){this.get_container().bind(this.get_settings(!0).state.events,a.proxy(function(){this.save_state()},this))},this))},defaults:{key:"jstree",events:"select_node.jstree open_node.jstree close_node.jstree deselect_node.jstree deselect_all.jstree"},_fn:{save_state:function(){var b=this.get_settings(!0).state;a.vakata.storage.set(b.key,this.get_state())},restore_state:function(){var b=this.get_settings(!0).state,c=a.vakata.storage.get(b.key);!c||this.set_state(c)}}})}(jQuery),function(a){var b=[];a.jstree.THEMES_DIR=!1,a.jstree.plugin("themes",{__construct:function(){this.get_container().bind("__construct.jstree",a.proxy(function(){var a=this.get_settings(!0).themes;this.data.themes.dots=a.dots,this.data.themes.icons=a.icons,a.url===!1&&a.theme===!1&&(a.theme=this.data.core.rtl?"default-rtl":"default"),this.set_theme(a.theme,a.url),this[this.data.themes.dots?"show_dots":"hide_dots"](),this[this.data.themes.icons?"show_icons":"hide_icons"]()},this))},defaults:{theme:!1,url:!1,dots:!0,icons:!0},_fn:{set_theme:function(c,d){if(!c)return!1;d||(d=a.jstree.THEMES_DIR+c+"/style.css"),a.inArray(d,b)===-1&&(a.vakata.css.add_sheet({url:d}),b.push(d)),this.data.themes.theme!==c&&(this.get_container().removeClass("jstree-"+this.data.themes.theme),this.data.themes.theme=c),this.get_container().addClass("jstree-"+c),this.__callback(c)},get_theme:function(){return this.data.themes.theme},show_dots:function(){this.data.themes.dots=!0,this.get_container().children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this.data.themes.dots=!1,this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){this.data.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this.data.themes.icons=!0,this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=!1,this.get_container().children("ul").addClass("jstree-no-icons")},toggle_icons:function(){this.data.themes.icons?this.hide_icons():this.show_icons()},set_icon:function(a,b){return a=this.get_node(a),!a||a===-1||!a.length?!1:(a=a.find("> a > .jstree-themeicon"),b===!1?this.hide_icon(a):b.indexOf("/")===-1?a.addClass(b).attr("rel",b):a.css("background","url('"+b+"') center center no-repeat").attr("rel",b),!0)},get_icon:function(a){return a=this.get_node(a),!a||a===-1||!a.length?null:(a=a.find("> a > .jstree-themeicon"),a.hasClass("jstree-themeicon-hidden")?!1:(a=a.attr("rel"),a&&a.length?a:null))},hide_icon:function(a){return a=this.get_node(a),!a||a===-1||!a.length?!1:(a.find("> a > .jstree-themeicon").addClass("jstree-themeicon-hidden"),!0)},show_icon:function(a){return a=this.get_node(a),!a||a===-1||!a.length?!1:(a.find("> a > .jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0)},clean_node:function(b){b=this.__call_old();var c=this;return b.each(function(){var b=a(this),d=b.data("jstree");b.find("> a > ins.jstree-themeicon").length||b.children("a").prepend("<ins class='jstree-icon jstree-themeicon'>&#160;</ins>"),d&&typeof d.icon!="undefined"&&(c.set_icon(b,d.icon),delete d.icon)})},get_state:function(){var a=this.__call_old();return a.themes={theme:this.get_theme(),icons:this.data.themes.icons,dots:this.data.themes.dots},a},set_state:function(a,b){return this.__call_old()?a.themes?(a.themes.theme&&this.set_theme(a.themes.theme),typeof a.themes.dots!="undefined"&&this[a.themes.dots?"show_dots":"hide_dots"](),typeof a.themes.icons!="undefined"&&this[a.themes.icons?"show_icons":"hide_icons"](),delete a.themes,this.set_state(a,b),!1):!0:!1},get_json:function(a,b){var c=this.__call_old(),d;return b&&(d=this.get_icon(a),typeof d!="undefined"&&d!==null&&(c.data.jstree.icon=d)),c}}}),a(function(){a.jstree.THEMES_DIR===!1&&a("script").each(function(){if(this.src.toString().match(/jstree[^\/]*?\.js(\?.*)?$/))return a.jstree.THEMES_DIR=this.src.toString().replace(/jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/",!1}),a.jstree.THEMES_DIR===!1&&(a.jstree.THEMES_DIR="themes/");var b=".jstree a { text-decoration:none; } .jstree a > .jstree-themeicon { height:16px; width:16px; margin-right:3px; } .jstree-rtl a > .jstree-themeicon { margin-left:3px; margin-right:0; } .jstree .jstree-no-icons .jstree-themeicon, .jstree .jstree-themeicon-hidden { display:none; } ";a.jstree.IS_IE6&&(b+=".jstree li a .jstree-themeicon { height:16px; width:16px; margin-right:3px; } .jstree-rtl li a .jstree-themeicon { margin-right:0px; margin-left:3px; } "),a.vakata.css.add_sheet({str:b,title:"jstree"})}),a.jstree.defaults.plugins.push("themes")}(jQuery),function(a){a.jstree.plugin("ui",{__construct:function(){this.data.ui.selected=a(),this.data.ui.hovered=null,this.data.ui.last_selected=!1,this.get_container().delegate("a","click.jstree",a.proxy(function(a){a.preventDefault(),a.currentTarget.blur();var b=this.get_settings(!0).ui,c=this.get_node(a.currentTarget),d=this.is_selected(c),e=b.select_multiple_modifier==="on"||b.select_multiple_modifier!==!1&&a&&a[b.select_multiple_modifier+"Key"],f=b.select_multiple_modifier==="on"||b.select_range_modifier!==!1&&a&&a[b.select_range_modifier+"Key"]&&this.data.ui.last_selected&&this.data.ui.last_selected[0]!==c[0]&&this.data.ui.last_selected.parent()[0]===c.parent()[0];switch(!0){case f&&this.data.ui.last_selected!==!1:this.select_range(c);break;case f&&this.data.ui.last_selected===!1:this.select_one(c);break;case d&&e:this.deselect_node(c);break;default:this.select_one(c,e)}},this)).delegate("a","mouseenter.jstree",a.proxy(function(a){this.hover_node(a.target)},this)).delegate("a","mouseleave.jstree",a.proxy(function(a){this.dehover_node(a.target)},this)).bind("delete_node.jstree",a.proxy(function(b,c){var d=this.get_node(c.rslt.obj),e=d&&d.length?d.find("a.jstree-clicked"):a(),f=this;e.each(function(){f.deselect_node(this)})},this)).bind("move_node.jstree",a.proxy(function(a,b){b.rslt.cy&&b.rslt.oc.find("a.jstree-clicked").removeClass("jstree-clicked")},this))},defaults:{select_multiple_modifier:"ctrl",select_range_modifier:"shift",disable_nested_selection:!0},_fn:{get_node:function(a,b){return typeof a=="undefined"||a===null?b?this.data.ui.selected:this.data.ui.last_selected:this.__call_old()},hover_node:function(a){a=this.get_node(a);if(!a||!a.length||this.is_loading(a))return!1;a.hasClass("jstree-hovered")||this.dehover_node(),this.data.ui.hovered=a.children("a").addClass("jstree-hovered").parent(),this.scroll_to_node(a),this.__callback({obj:a})},dehover_node:function(){var a=this.data.ui.hovered,b;if(!a||!a.length)return!1;b=a.children("a").removeClass("jstree-hovered").parent(),this.data.ui.hovered[0]===b[0]&&(this.data.ui.hovered=null),this.__callback({obj:a})},select_node:function(a){var b=this;a=this.get_node(a);if(a===-1||!a||!a.length||this.is_loading(a))return!1;a.children("a").addClass("jstree-clicked"),this.data.ui.last_selected=a,this.data.ui.selected=this.data.ui.selected.add(a),a.parents(".jstree-closed").each(function(){b.open_node(this,!1,0)}),this.__callback({obj:a})},deselect_node:function(a){a=this.get_node(a);if(!a||!a.length)return!1;this.is_selected(a)&&(a.children("a").removeClass("jstree-clicked"),this.data.ui.selected=this.data.ui.selected.not(a),this.data.ui.last_selected.get(0)===a.get(0)&&(this.data.ui.last_selected=this.data.ui.selected.eq(0)),this.__callback({obj:a}))},deselect_all:function(b){var c=b?a(b).find("a.jstree-clicked").parent():this.get_container().find("a.jstree-clicked").parent();c.children("a.jstree-clicked").removeClass("jstree-clicked"),this.data.ui.selected=a(),this.data.ui.last_selected=!1,this.__callback({obj:c})},is_selected:function(a){return this.data.ui.selected.index(this.get_node(a))>=0},get_selected:function(b){return b?a(b).find("a.jstree-clicked").parent():this.data.ui.selected},select_range:function(a,b,c){var d=this,e,f;return a=this.get_node(a),b||(f=!0,b=this.data.ui.last_selected),b=this.get_node(b),a===-1||!a||!a.length||this.is_loading(a)?!1:b===-1||!b||!b.length||this.is_loading(b)?!1:(c||this.deselect_all(),e=a.index()<b.index(),b.addClass("jstree-last-selected"),a=a[e?"nextUntil":"prevUntil"](".jstree-last-selected").andSelf().add(".jstree-last-selected"),b.removeClass("jstree-last-selected"),e||(a=a.vakata_reverse()),a.length?(a.each(function(){d.select_node(this)}),f&&(this.data.ui.last_selected=b),this.__callback({obj:a}),!0):!1)},select_one:function(a,b){a=this.get_node(a);if(a===-1||!a||!a.length||this.is_loading(a))return!1;if(!b)this.deselect_all();else if(this.get_settings(!0).ui.disable_nested_selection&&(a.parentsUntil(".jstree","li").children("a.jstree-clicked:eq(0)").length||a.children("ul").find("a.jstree-clicked:eq(0)").length))return!1;return this.select_node(a),this.__callback({obj:a}),!0},clean_node:function(b){b=this.__call_old();var c=this;return b.each(function(){var b=a(this),d=b.data("jstree");b.find(".jstree-clicked").removeClass("jstree-clicked"),d&&d.selected&&(c.select_node(b),delete d.selected)})},get_state:function(){var a=this.__call_old();return a.selected=[],this.data.ui.selected.each(function(){a.selected.push(this.id)}),a},set_state:function(b,c){if(this.__call_old()){if(b.selected){var d=this;return this.deselect_all(),a.each(b.selected,function(a,b){d.select_node(document.getElementById(b))}),delete b.selected,this.set_state(b,c),!1}return!0}return!1},get_json:function(a,b){var c=this.__call_old();return b&&this.is_selected(a)&&(c.data.jstree.selected=!0),c}}}),a.jstree.defaults.plugins.push("ui")}(jQuery),function(a){a.jstree.plugin("unique",{_fn:{check:function(b,c,d,e){if(!this.__call_old())return!1;d=d===-1?this.get_container():d;var f=b==="rename_node"?a("<div />").html(e).text():this.get_text(c,!0),g=[],h=this;d.children("ul").children("li").each(function(){g.push(h.get_text(this,!0))});switch(b){case"delete_node":return!0;case"rename_node":case"copy_node":return a.inArray(f,g)===-1;case"move_node":return d.children("ul").children("li").index(c)!==-1||a.inArray(f,g)===-1}return!0}}}),a.jstree.defaults.plugins.push("unique")}(jQuery),function(a){var b={nest:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" /><xsl:template match="/">\t<xsl:call-template name="nodes">\t\t<xsl:with-param name="node" select="/root" />\t</xsl:call-template></xsl:template><xsl:template name="nodes">\t<xsl:param name="node" />\t<ul>\t<xsl:for-each select="$node/item">\t\t<xsl:variable name="children" select="count(./item) &gt; 0" />\t\t<li>\t\t\t<xsl:for-each select="@*"><xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute></xsl:for-each>\t\t\t<a>\t\t\t\t<xsl:for-each select="./content/@*"><xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute></xsl:for-each>\t\t\t\t<xsl:copy-of select="./content/child::node()" />\t\t\t</a>\t\t\t<xsl:if test="$children"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>\t\t</li>\t</xsl:for-each>\t</ul></xsl:template></xsl:stylesheet>',flat:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" /><xsl:template match="/">\t<ul>\t<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">\t\t<xsl:call-template name="nodes">\t\t\t<xsl:with-param name="node" select="." />\t\t</xsl:call-template>\t</xsl:for-each>\t</ul></xsl:template><xsl:template name="nodes">\t<xsl:param name="node" />\t<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />\t<li>\t\t<xsl:for-each select="@*">\t\t\t<xsl:if test="name() != \'parent_id\'">\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t</xsl:if>\t\t</xsl:for-each>\t\t<a>\t\t\t<xsl:for-each select="./content/@*"><xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute></xsl:for-each>\t\t\t<xsl:copy-of select="./content/child::node()" />\t\t</a>\t\t<xsl:if test="$children">\t\t<ul>\t\t\t<xsl:for-each select="//item[@parent_id=$node/attribute::id]">\t\t\t\t<xsl:call-template name="nodes">\t\t\t\t\t<xsl:with-param name="node" select="." />\t\t\t\t</xsl:call-template>\t\t\t</xsl:for-each>\t\t</ul>\t\t</xsl:if>\t</li></xsl:template></xsl:stylesheet>'},c=function(a){return a.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};a.jstree.plugin("xml",{defaults:{xsl:"flat",data:!1,ajax:!1},_fn:{_append_xml_data:function(c,d){return d=a.vakata.xslt(d,b[this.get_settings().xml.xsl]),d===!1?!1:(d=a(d),!d||!d.length||!d.is("ul, li")?!1:(c=this.get_node(c),c===-1&&(c=this.get_container()),c.length?(c.children("ul").length||c.append("<ul />"),c.children("ul").empty().append(d.is("ul")?d.children("li"):d),!0):!1))},_load_node:function(b,c){var d=!1,e=this.get_settings().xml;b=this.get_node(b);if(!b)return!1;switch(!0){case a.isFunction(e.data):return e.data.call(this,b,a.proxy(function(a){return c.call(this,this._append_xml_data(b,a))},this));case!!e.data&&!e.ajax||!!e.data&&!!e.ajax&&b===-1:return c.call(this,this._append_xml_data(b,e.data));case!e.data&&!!e.ajax||!!e.data&&!!e.ajax&&b!==-1:return e.ajax.success=a.proxy(function(d,e,f){var g=this.get_settings().xml.ajax;a.isFunction(g.success)&&(d=g.success.call(this,d,e,f)||d),c.call(this,this._append_xml_data(b,d))},this),e.ajax.error=a.proxy(function(b,d,e){var f=this.get_settings().xml.ajax;a.isFunction(f.error)&&f.error.call(this,b,d,e),c.call(this,!1)},this),e.ajax.dataType||(e.ajax.dataType="xml"),a.isFunction(e.ajax.url)&&(e.ajax.url=e.ajax.url.call(this,b)),a.isFunction(e.ajax.data)&&(e.ajax.data=e.ajax.data.call(this,b)),a.ajax(e.ajax)}},get_xml:function(b,d,e){var f="";return b||(b="flat"),typeof e=="undefined"?(d=this.get_json(d),a.each(d,a.proxy(function(a,c){f+=this.get_xml(b,c,!0)},this)),'<?xml version="1.0" encoding="utf-8" ?><root>'+f+"</root>"):(f+="<item",b==="flat"&&e!==!0&&(f+=' parent_id="'+c(e)+'"'),d.data&&!a.isEmptyObject(d.data)&&a.each(d.data,function(b,d){a.isEmptyObject(d)||(f+=" data-"+b+'="'+c(a.vakata.json.encode(d))+'"')}),a.each(d.li_attr,function(a,b){f+=" "+a+'="'+c(b)+'"'}),f+=">",f+="<content",a.each(d.a_attr,function(a,b){f+=" "+a+'="'+c(b)+'"'}),f+="><![CDATA["+d.title+"]]></content>",b==="flat"&&(f+="</item>"),d.children&&a.each(d.children,a.proxy(function(a,c){f+=this.get_xml(b,c,d.li_attr&&d.li_attr.id?d.li_attr.id:!0)},this)),b==="nest"&&(f+="</item>"),f)}}}),a.jstree.defaults.plugins.push("xml")}(jQuery)